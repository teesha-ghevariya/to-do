<div 
  class="node-item" 
  [class.selected]="isSelected"
  [style.padding-left.px]="depth * 24" 
  (dblclick)="onDoubleClick()"
  (click)="selectionService.selectNode(node.id, $event)"
  draggable="true"
  (dragstart)="onDragStart($event)"
  (dragend)="onDragEnd($event)"
  (dragover)="onDragOver($event)"
  (drop)="onDrop($event)"
>
  <div class="node-content">
    <div class="input-container">
      <div class="content-wrapper">
        <input
          #inputElement
          type="text"
          [(ngModel)]="editContent"
          (focus)="onFocus()"
          (blur)="onBlur()"
          (keydown)="onKeyDown($event)"
          class="node-input"
          [class.editing]="isEditing"
          [class.completed]="isCompleted"
          placeholder="Add an item..."
        />
        
        <!-- Tags display -->
        <div class="tags-container" *ngIf="extractTags(editContent).length > 0">
          <span 
            *ngFor="let tag of extractTags(editContent)" 
            class="tag"
          >
            #{{ tag }}
          </span>
        </div>
      </div>
      
      <!-- Expand/Collapse arrow on the right side (only when node has children) -->
      <span 
        *ngIf="hasChildren"
        class="bullet" 
        [class.has-children]="hasChildren" 
        [class.expanded]="isExpanded" 
        (click)="onBulletClick()"
      >
        <span class="bullet-icon">{{ isExpanded ? '▼' : '▶' }}</span>
      </span>
      
      <!-- Completion checkbox -->
      <button 
        class="completion-checkbox" 
        [class.completed]="isCompleted"
        (click)="toggleCompletion()"
        *ngIf="editContent.trim()"
      >
        <span class="checkmark" *ngIf="isCompleted">✓</span>
      </button>
    </div>
  </div>
</div>

