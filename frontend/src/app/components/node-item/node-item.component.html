<div 
  class="node-item" 
  [class.selected]="isSelected"
  [style.padding-left.px]="depth * 24" 
  (dblclick)="onDoubleClick()"
  (click)="selectionService.selectNode(node.id, $event)"
  draggable="true"
  (dragstart)="onDragStart($event)"
  (dragend)="onDragEnd($event)"
  (dragover)="onDragOver($event)"
  (drop)="onDrop($event)"
>
  <div class="node-content">
    <!-- Expand/Collapse arrow on the left side -->
    <span 
      *ngIf="hasChildren"
      class="bullet" 
      [class.has-children]="hasChildren" 
      [class.expanded]="isExpanded" 
      (click)="onBulletClick()"
      title="Toggle children"
    >
      <span class="bullet-icon">{{ isExpanded ? '▾' : '▸' }}</span>
    </span>

    <!-- Dot when no children -->
    <span *ngIf="!hasChildren" class="bullet bullet-dot">•</span>

    <div class="input-container">
      <!-- Completion checkbox -->
      <button 
        class="completion-checkbox" 
        [class.completed]="isCompleted"
        (click)="toggleCompletion()"
        *ngIf="editContent.trim()"
      >
        <span class="checkmark" *ngIf="isCompleted">✓</span>
      </button>

      <div class="content-wrapper">
        <input
          #inputElement
          type="text"
          [(ngModel)]="editContent"
          (focus)="onFocus()"
          (blur)="onBlur()"
          (keydown)="onKeyDown($event)"
          class="node-input"
          [class.editing]="isEditing"
          [class.completed]="isCompleted"
          placeholder="Add an item..."
        />
        
        <!-- Tags display -->
        <div class="tags-container" *ngIf="extractTags(editContent).length > 0">
          <span 
            *ngFor="let tag of extractTags(editContent)" 
            class="tag"
          >
            #{{ tag }}
          </span>
        </div>
      </div>
    </div>
  </div>
</div>

